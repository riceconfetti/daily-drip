---
import Layout from "../layouts/Layout.astro";
import CalendarWidget from "../components/CalendarWidget.svelte";
import EventsWidget from "../components/events-widget/event-data.astro";
import { getCollection } from "astro:content";

const genshin = (
  await getCollection("events", async ({ data }) => {
    return data.game.id == "genshin" && data.status == "confirmed";
  })
).map((e) => e.data.startDate);

const starrail = (
  await getCollection("events", async ({ data }) => {
    return data.game.id == "starrail" && data.status == "confirmed";
  })
).map((e) => e.data.startDate);

const reverse = (
  await getCollection("events", async ({ data }) => {
    return data.game.id == "reverse" && data.status == "confirmed";
  })
).map((e) => e.data.startDate);

const wuwa = (
  await getCollection("events", async ({ data }) => {
    return data.game.id == "wuwa" && data.status == "confirmed";
  })
).map((e) => e.data.startDate);
---

<Layout title="The Daily Drip">
  <section
    class="p-4 flex flex-col gap-4 md:max-w-[1400px] md:grid md:grid-cols-[60%_auto] md:grow md:grid-rows-[fit-content(theme(spacing.32))] md:gap-8"
  >
    <div class="p-4 bg-dark bg-opacity-20 rounded-md md:col-span-2 h-min">
      <p class="playfair-display-regular text-sm">
        Welcome to <span class="font-bold text-center">The Daily Drip</span>,
        your place for gacha game leaks and speculations! These are my personal
        predictions for upcoming gacha banners, and you use this data at your
        own risk!
      </p>
    </div>
    <CalendarWidget {genshin} {wuwa} {reverse} {starrail} client:load />
    <EventsWidget />
  </section>
</Layout>
